#N canvas 885 521 443 557 10;
#X declare -path abs;
#X obj 10 10 cnv 15 400 110 empty empty empty 20 12 0 14 #e0e0e0 #404040 0;
#N canvas 148 268 952 691 analyze_MIDI_file 0;
#X obj 32 36 inlet;
#X obj 202 35 inlet;
#X obj 73 344 last3values;
#X obj 49 143 midi-player;
#X obj 49 94 openpanel;
#X msg 49 118 read \$1;
#X msg 200 386 open;
#X msg 72 370 merge \$1 \$2;
#X msg 250 402 clear;
#X obj 69 221 unpack 0 0 0 0;
#X obj 72 246 stripnote;
#X text 160 222 tick note vel chan;
#X text 132 244 we just use note and vel and filter note off;
#X obj 73 430 cyclone/coll order2;
#C restore;
#X msg 275 137 flush;
#X text 7 15 open MIDI file;
#X text 200 15 view probab;
#N canvas 674 231 584 262 first2values 0;
#X obj 11 12 inlet;
#X msg 55 41 0;
#X obj 40 78 + 1;
#X obj 11 105 sel 0 1;
#X obj 11 78 i;
#X obj 12 135 i;
#X obj 11 41 t b f;
#X obj 43 135 i;
#X obj 12 187 cyclone/sprintf %i%i;
#X obj 12 212 outlet;
#X obj 13 162 swap;
#X obj 55 12 inlet;
#X text 106 12 this stores the 1st two notes of the MIDI for using them also as the starting 2 notes of the algorithmic recreation;
#X connect 0 0 6 0;
#X connect 1 0 4 1;
#X connect 2 0 4 1;
#X connect 3 0 5 0;
#X connect 3 1 7 0;
#X connect 4 0 3 0;
#X connect 4 0 2 0;
#X connect 5 0 10 1;
#X connect 6 0 4 0;
#X connect 6 1 5 1;
#X connect 6 1 7 1;
#X connect 7 0 10 0;
#X connect 8 0 9 0;
#X connect 10 0 8 0;
#X connect 10 1 8 1;
#X connect 11 0 1 0;
#X restore 99 292 pd first2values;
#X floatatom 99 317 5 0 0 0 - - - 0;
#X obj 72 270 t f f;
#X msg 220 330 \; first2 \$1;
#X obj 32 60 t b b;
#X obj 109 30 inlet;
#X text 105 16 analyse;
#X obj 275 81 t b b;
#X msg 302 102 \; reset bang;
#X obj 186 271 r reset;
#X obj 136 321 r reset;
#X obj 91 167 unpack 0 0 0 0 0;
#X obj 184 192 outlet;
#X obj 250 380 r reset;
#X connect 0 0 21 0;
#X connect 1 0 6 0;
#X connect 2 0 7 0;
#X connect 3 1 9 0;
#X connect 3 2 28 0;
#X connect 4 0 5 0;
#X connect 5 0 3 0;
#X connect 6 0 13 0;
#X connect 7 0 13 0;
#X connect 8 0 13 0;
#X connect 9 1 10 0;
#X connect 9 2 10 1;
#X connect 10 0 19 0;
#X connect 14 0 3 0;
#X connect 17 0 18 0;
#X connect 18 0 20 0;
#X connect 19 0 2 0;
#X connect 19 1 17 0;
#X connect 21 0 4 0;
#X connect 22 0 24 0;
#X connect 24 0 14 0;
#X connect 24 1 25 0;
#X connect 26 0 17 1;
#X connect 27 0 2 1;
#X connect 28 4 29 0;
#X connect 30 0 8 0;
#X restore 31 67 pd analyze_MIDI_file;
#X msg 31 19 load MIDI file;
#X msg 148 41 view probabilities;
#X msg 89 41 analyse;
#X floatatom 31 90 5 0 0 1 BPM - BPM 0;
#X obj 11 132 cnv 15 400 400 empty empty empty 20 12 0 14 #fcc4c4 #404040 0;
#X obj 103 294 metro 200;
#X obj 103 165 tgl 15 0 empty empty PLAY 17 7 0 10 #fcfcfc #000000 #000000 0 1;
#X obj 21 428 makenote;
#X obj 265 347 hsl 128 15 0.2 2 0 0 empty empty staccato->legato 10 -8 0 10 #fcfcfc #000000 #000000 0 1;
#X floatatom 262 366 5 0 0 0 - - - 0;
#X msg 43 407 100;
#X obj 21 456 noteout;
#N canvas 240 48 697 540 getnextnote 0;
#X obj 94 257 cyclone/coll order2;
#C restore;
#X obj 36 462 i;
#X obj 193 293 list length;
#X floatatom 193 314 5 0 0 0 - - - 0;
#X obj 193 357 random;
#X obj 193 335 t b f;
#X floatatom 193 378 5 0 0 0 - - - 0;
#X floatatom 95 449 5 0 0 0 - - - 0;
#X obj 94 419 cyclone/zl nth \$1;
#X obj 94 280 t l l;
#X text 279 286 once we have a list \, we need to get a random element from it \, so we calculate its length and generate a random value between 0 and length and we output this nth element;
#X obj 94 214 last2values;
#X floatatom 94 193 5 0 0 0 - - - 0;
#X floatatom 56 175 5 0 0 0 - - - 0;
#X obj 55 151 % 100;
#X obj 94 152 / 100;
#X obj 94 173 i;
#X floatatom 94 236 5 0 0 0 - - - 0;
#X obj 193 398 + 1;
#X obj 55 125 t b f f;
#X floatatom 71 69 5 0 0 0 - - - 0;
#X obj 71 45 r first2;
#X obj 56 93 i;
#X msg 17 57 bang;
#X obj 36 488 outlet;
#X obj 17 28 inlet;
#X obj 142 28 inlet;
#X text 15 9 init;
#X text 139 10 next note;
#X obj 178 83 outlet;
#X text 223 84 first 2 notes (just for checking);
#X connect 0 0 9 0;
#X connect 1 0 11 0;
#X connect 1 0 24 0;
#X connect 2 0 3 0;
#X connect 3 0 5 0;
#X connect 4 0 6 0;
#X connect 5 0 4 0;
#X connect 5 1 4 1;
#X connect 6 0 18 0;
#X connect 7 0 1 1;
#X connect 8 0 7 0;
#X connect 9 0 8 0;
#X connect 9 1 2 0;
#X connect 11 0 17 0;
#X connect 12 0 11 0;
#X connect 13 0 1 1;
#X connect 14 0 13 0;
#X connect 15 0 16 0;
#X connect 16 0 12 0;
#X connect 17 0 0 0;
#X connect 18 0 8 1;
#X connect 19 1 14 0;
#X connect 19 2 15 0;
#X connect 20 0 22 1;
#X connect 20 0 29 0;
#X connect 21 0 20 0;
#X connect 22 0 19 0;
#X connect 23 0 22 0;
#X connect 25 0 23 0;
#X connect 26 0 1 0;
#X restore 21 316 pd getnextnote;
#X obj 103 235 t f b;
#X msg 130 260 \; initplay bang;
#X floatatom 103 337 5 0 0 1 first_2_notes - - 0;
#X obj 43 386 r initplay;
#X obj 21 295 r initplay;
#X msg 262 315 0.95;
#X obj 229 412 * 0.95;
#X obj 232 174 hsl 128 15 40 200 0 0 empty BPM BPM -2 -8 0 10 #fcfcfc #000000 #000000 0 1;
#X floatatom 229 194 5 0 0 1 BPM - - 0;
#X floatatom 229 279 5 0 0 1 ms - - 0;
#X msg 150 235 reset;
#X obj 262 386 t b f;
#X text 180 71 1 load a MIDI file 2 analyse it;
#X text 24 143 Monophonic play with these probs;
#X text 73 406 velocity 0-127;
#X obj 229 258 * 0.25;
#X msg 229 216 60000 \$1;
#X obj 229 236 /;
#X obj 20 508 declare -path abs;
#X connect 1 0 5 0;
#X connect 2 0 1 0;
#X connect 3 0 1 2;
#X connect 4 0 1 1;
#X connect 7 0 14 1;
#X connect 8 0 15 0;
#X connect 9 0 13 0;
#X connect 9 1 13 1;
#X connect 10 0 11 0;
#X connect 11 0 26 0;
#X connect 12 0 9 1;
#X connect 14 0 9 0;
#X connect 14 1 17 0;
#X connect 15 0 7 0;
#X connect 15 1 16 0;
#X connect 18 0 12 0;
#X connect 19 0 14 0;
#X connect 20 0 10 0;
#X connect 21 0 9 2;
#X connect 22 0 23 0;
#X connect 23 0 31 0;
#X connect 24 0 7 1;
#X connect 24 0 21 0;
#X connect 25 0 16 0;
#X connect 26 0 21 0;
#X connect 26 1 21 1;
#X connect 30 0 24 0;
#X connect 31 0 32 0;
#X connect 32 0 30 0;
